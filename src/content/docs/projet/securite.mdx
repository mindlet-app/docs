---
title: S√©curit√© et protection des donn√©es
description: Mesures de s√©curit√© et conformit√© RGPD
sidebar:
  order: 2
---

import { Aside, Badge, Card, CardGrid, Steps, TabItem, Tabs } from '@astrojs/starlight/components';
import MermaidDownload from '../../../components/MermaidDownload.astro';

# üîí S√©curit√© et protection des donn√©es

<Aside type="caution">
  La s√©curit√© et la protection des donn√©es sont au c≈ìur de notre architecture. Nous respectons les normes **RGPD** et les meilleures pratiques de s√©curit√©.
</Aside>

## Vue d'ensemble

Mindlet manipule des donn√©es sensibles (contenus √©ducatifs personnels, donn√©es d'apprentissage) et doit garantir :

- **Confidentialit√©** : Les donn√©es ne sont accessibles qu'aux utilisateurs autoris√©s
- **Int√©grit√©** : Les donn√©es ne peuvent √™tre modifi√©es sans autorisation
- **Disponibilit√©** : Le service reste accessible de mani√®re fiable

## S√©curit√© des communications

### HTTPS obligatoire

<Badge text="TLS 1.3" variant="success" />

Toutes les communications sont chiffr√©es :

<MermaidDownload title="Communication TLS">
```mermaid
flowchart LR
    subgraph Mobile["üì± Mobile App"]
        MA[Application]
    end
    
    subgraph Backend["üîí API Backend"]
        API[Serveur]
    end
    
    MA <-->|"üîê TLS 1.3\nCertificat Let's Encrypt"| API
    
    style Mobile fill:#1565c0,stroke:#1976d2
    style Backend fill:#2e7d32,stroke:#388e3c
```
</MermaidDownload>

**Configuration :**
- Protocole : **TLS 1.3** (minimum TLS 1.2)
- Certificats : **Let's Encrypt** (renouvellement automatique)
- HSTS : Activ√© avec `max-age=31536000`
- Cipher suites : Suites modernes uniquement

### Protection des API

```php
// Middleware de s√©curit√© Laravel
Route::middleware([
    'auth:sanctum',           // Authentification JWT
    'throttle:60,1',          // Rate limiting
    'verified',               // Email v√©rifi√©
    EnsureJsonResponse::class // R√©ponses JSON uniquement
])->group(function () {
    // Routes prot√©g√©es
});
```

## Authentification et autorisation

### Authentification JWT

<Steps>
1. L'utilisateur envoie ses credentials (email/password)
2. Le serveur v√©rifie et g√©n√®re un JWT sign√©
3. Le token contient l'ID utilisateur et l'expiration
4. Le client stocke le token de mani√®re s√©curis√©e
5. Chaque requ√™te inclut le token dans le header `Authorization`
</Steps>

```php
// G√©n√©ration du token
$token = $user->createToken('mobile-app', [
    'expires_at' => now()->addDays(7),
])->plainTextToken;

// Structure du token (d√©cod√©)
{
    "sub": "user_123",
    "iat": 1705536000,
    "exp": 1706140800,
    "scopes": ["read", "write"]
}
```

### Stockage s√©curis√© c√¥t√© mobile

```typescript
import * as SecureStore from 'expo-secure-store';

// Stockage du token
await SecureStore.setItemAsync('auth_token', token, {
  keychainAccessible: SecureStore.WHEN_UNLOCKED,
});

// R√©cup√©ration du token
const token = await SecureStore.getItemAsync('auth_token');
```

### Politiques d'autorisation

```php
class CardPolicy
{
    public function view(User $user, Card $card): bool
    {
        // Seul le propri√©taire ou les membres du groupe peuvent voir
        return $card->user_id === $user->id 
            || $card->collection->isSharedWith($user);
    }
    
    public function update(User $user, Card $card): bool
    {
        // Seul le propri√©taire peut modifier
        return $card->user_id === $user->id;
    }
    
    public function delete(User $user, Card $card): bool
    {
        return $card->user_id === $user->id;
    }
}
```

## Protection des donn√©es

### Chiffrement en base de donn√©es

<Tabs>
  <TabItem label="Donn√©es sensibles">
    ```php
    use Illuminate\Database\Eloquent\Casts\Attribute;

    class User extends Model
    {
        protected function personalNotes(): Attribute
        {
            return Attribute::make(
                get: fn ($value) => decrypt($value),
                set: fn ($value) => encrypt($value),
            );
        }
    }
    ```
    
    **Donn√©es chiffr√©es :**
    - Notes personnelles
    - Pr√©f√©rences d'apprentissage
    - Donn√©es m√©dicales (troubles d'apprentissage)
  </TabItem>
  
  <TabItem label="Mots de passe">
    ```php
    // Hashage bcrypt avec cost factor 12
    $hashedPassword = Hash::make($password, [
        'rounds' => 12,
    ]);
    
    // V√©rification
    if (Hash::check($password, $hashedPassword)) {
        // Authentification r√©ussie
    }
    ```
    
    **Politique de mots de passe :**
    - Minimum 8 caract√®res
    - Au moins 1 majuscule, 1 minuscule, 1 chiffre
    - V√©rification contre les mots de passe compromis (HaveIBeenPwned)
  </TabItem>
</Tabs>

### Validation des entr√©es

```php
class CreateCardRequest extends FormRequest
{
    public function rules(): array
    {
        return [
            'question' => [
                'required',
                'string',
                'max:1000',
                new NoHtmlContent(), // Emp√™che l'injection HTML
            ],
            'answer' => [
                'required',
                'string',
                'max:5000',
                new NoHtmlContent(),
            ],
            'collection_id' => [
                'required',
                'exists:collections,id',
                new UserOwnsCollection(), // V√©rifie l'ownership
            ],
        ];
    }
}
```

### Protection contre les attaques courantes

| Attaque | Protection |
|---------|------------|
| **SQL Injection** | Eloquent ORM, requ√™tes pr√©par√©es |
| **XSS** | √âchappement automatique, CSP headers |
| **CSRF** | Tokens CSRF (sessions web) |
| **Brute Force** | Rate limiting, captcha apr√®s 5 √©checs |
| **Mass Assignment** | `$fillable` explicite sur les mod√®les |

## Conformit√© RGPD

<Badge text="RGPD Compliant" variant="success" size="large" />

### Principes respect√©s

<CardGrid>
  <Card title="Minimisation des donn√©es" icon="document">
    Nous ne collectons que les donn√©es strictement n√©cessaires au fonctionnement du service.
  </Card>
  <Card title="Consentement explicite" icon="approve-check">
    L'utilisateur donne son consentement clair avant toute collecte de donn√©es.
  </Card>
  <Card title="Droit d'acc√®s" icon="magnifier">
    L'utilisateur peut consulter toutes ses donn√©es √† tout moment.
  </Card>
  <Card title="Droit √† l'effacement" icon="close">
    L'utilisateur peut supprimer son compte et toutes ses donn√©es.
  </Card>
</CardGrid>

### Donn√©es collect√©es

| Cat√©gorie | Donn√©es | Finalit√© | Dur√©e de conservation |
|-----------|---------|----------|----------------------|
| **Compte** | Email, nom, mot de passe (hash√©) | Authentification | Jusqu'√† suppression du compte |
| **Contenu** | Documents, cartes, collections | Service | Jusqu'√† suppression par l'utilisateur |
| **Apprentissage** | Progression, scores, temps | Personnalisation | 2 ans apr√®s derni√®re connexion |
| **Technique** | Logs, IP, device | S√©curit√©, debug | 1 an |

### Impl√©mentation des droits

```php
class UserDataController extends Controller
{
    // Droit d'acc√®s - Export des donn√©es
    public function exportData(Request $request): JsonResponse
    {
        $user = $request->user();
        
        $data = [
            'profile' => $user->only(['name', 'email', 'created_at']),
            'collections' => $user->collections->load('cards'),
            'progress' => $user->learningProgress,
            'preferences' => $user->preferences,
        ];
        
        return response()->json($data);
    }
    
    // Droit √† l'effacement
    public function deleteAccount(Request $request): JsonResponse
    {
        $user = $request->user();
        
        // Suppression en cascade
        $user->collections()->delete();
        $user->documents()->delete();
        $user->notifications()->delete();
        
        // Anonymisation des logs
        Log::info('User account deleted', ['user_id' => $user->id]);
        
        // Suppression du compte
        $user->delete();
        
        return response()->json(['message' => 'Account deleted']);
    }
}
```

### Sous-traitants et transferts

<Aside type="note">
  Tous nos sous-traitants sont situ√©s dans l'**Union Europ√©enne** pour garantir la conformit√© RGPD.
</Aside>

| Service | Fournisseur | Localisation | Donn√©es trait√©es |
|---------|-------------|--------------|------------------|
| **H√©bergement** | OVHcloud | France üá´üá∑ | Toutes les donn√©es |
| **Serveurs** | Hetzner | Allemagne üá©üá™ | Donn√©es de traitement |
| **Email** | - | UE | Emails transactionnels |
| **LLM** | OpenAI | Accord DPA | Contenu pour g√©n√©ration |

## √âthique de l'IA

<Aside type="caution">
  L'utilisation de l'intelligence artificielle soul√®ve des questions √©thiques importantes que nous prenons en compte.
</Aside>

### Principes √©thiques

1. **Transparence** : L'utilisateur sait quand l'IA est utilis√©e
2. **Contr√¥le humain** : L'utilisateur peut modifier/supprimer le contenu g√©n√©r√©
3. **Non-discrimination** : Pas de biais dans les contenus g√©n√©r√©s
4. **Respect de la propri√©t√© intellectuelle** : Pas de copie de contenus prot√©g√©s

### Mesures concr√®tes

```python
class EthicalAIService:
    async def generate_content(self, input: str) -> GeneratedContent:
        # V√©rification du contenu d'entr√©e
        if self.contains_sensitive_content(input):
            raise EthicalViolationError("Contenu sensible d√©tect√©")
        
        # G√©n√©ration avec garde-fous
        content = await self.llm.generate(
            input,
            system_prompt=ETHICAL_SYSTEM_PROMPT,
            max_tokens=1000,
        )
        
        # V√©rification du contenu g√©n√©r√©
        if self.contains_harmful_content(content):
            raise EthicalViolationError("Contenu g√©n√©r√© inappropri√©")
        
        # Ajout de m√©tadonn√©es de tra√ßabilit√©
        return GeneratedContent(
            content=content,
            generated_at=datetime.now(),
            model_version=self.model_version,
            is_ai_generated=True,
        )
```

## Audits et monitoring

### Journalisation des acc√®s

```php
// Logging des actions sensibles
Log::channel('security')->info('Sensitive action', [
    'action' => 'data_export',
    'user_id' => $user->id,
    'ip' => $request->ip(),
    'user_agent' => $request->userAgent(),
    'timestamp' => now(),
]);
```

### Alertes de s√©curit√©

| √âv√©nement | Alerte | Action |
|-----------|--------|--------|
| 5 tentatives de login √©chou√©es | Email √† l'utilisateur | Blocage temporaire |
| Connexion depuis nouveau pays | Email de v√©rification | Validation requise |
| Export de donn√©es | Email de confirmation | Notification |
| Changement de mot de passe | Email de notification | - |

---

*La s√©curit√© n'est pas une option, c'est une fondation.*
